import{a as q}from"./chunk-6BEIHAVR.js";import{F as T,G as B,N as V}from"./chunk-UM43KZWY.js";import{a as j}from"./chunk-L2BAENBY.js";import"./chunk-EV7PFGVU.js";import{a as w,b as l,d as O,e as P,g as S,h as k,i as A,j as N,k as I,l as F,m as D,n as z,o as R}from"./chunk-S33ANCWB.js";import{a as G}from"./chunk-HVD7EZ4V.js";import{$a as g,Ab as _,Ca as d,Da as t,Ea as e,Fa as m,Kb as C,La as c,Mb as E,N as s,Nb as M,_a as n,a as f,ga as u,l as h,mb as v,nb as x,ra as b,wa as p,zb as y}from"./chunk-IKTNIUHG.js";var Y=["\u0637\u0639\u0627\u0645","\u0645\u0648\u0627\u0635\u0644\u0627\u062A","\u062A\u0633\u0648\u0642","\u0641\u0648\u0627\u062A\u064A\u0631","\u0635\u062D\u0629","\u062A\u0639\u0644\u064A\u0645","\u062A\u0631\u0641\u064A\u0647","\u0645\u0646\u0632\u0644","\u0647\u062F\u0627\u064A\u0627","\u0623\u062E\u0631\u0649"];function X(i,r){i&1&&(t(0,"div",22),n(1," \u0623\u062F\u062E\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D "),e())}function $(i,r){if(i&1&&(t(0,"option",23),n(1),e()),i&2){let o=r.$implicit;d("value",o),u(),g(o)}}var L=class i{fb=s(z);expenses=s(j);toast=s(G);route=s(C);router=s(E);id=q(this.route.paramMap.pipe(h(r=>r.get("id"))),{initialValue:null});isEdit=v(()=>!!this.id());defaults=this.expenses.createDefaultsForNow();categories=Y;form=this.fb.group({amount:this.fb.control(this.defaults.amount,[l.required,l.min(.01)]),category:this.fb.control(this.defaults.category,[l.required]),description:this.fb.control(this.defaults.description),date:this.fb.control(this.defaults.date,[l.required]),time:this.fb.control(this.defaults.time,[l.required]),paymentMethod:this.fb.control(this.defaults.paymentMethod,[l.required])});loadedId=null;constructor(){x(()=>{let r=this.id();this.tryLoad(r)})}async tryLoad(r){if(!r||this.loadedId===r)return;this.loadedId=r;let o=await this.expenses.getById(r);if(!o){this.toast.show("\u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u063A\u064A\u0631 \u0645\u0648\u062C\u0648\u062F","danger"),await this.router.navigateByUrl("/");return}this.form.patchValue({amount:o.amount,category:o.category,description:o.description,date:o.date,time:o.time,paymentMethod:o.paymentMethod})}async save(){if(this.form.invalid){this.form.markAllAsTouched();return}let r=this.form.getRawValue();if(this.isEdit()){if(!await this.expenses.update(f({id:this.id()},r))){this.toast.show("\u062A\u0639\u0630\u0631 \u0627\u0644\u062D\u0641\u0638","danger");return}this.toast.show("\u062A\u0645 \u0627\u0644\u062A\u062D\u062F\u064A\u062B","success")}else await this.expenses.add(r),this.toast.show("\u062A\u0645\u062A \u0627\u0644\u0625\u0636\u0627\u0641\u0629","success");await this.router.navigateByUrl("/")}async cancel(){await this.router.navigateByUrl("/")}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=b({type:i,selectors:[["app-add-expense"]],decls:50,vars:4,consts:[[1,"head"],[1,"title"],[1,"subtitle"],["routerLink","/",1,"link"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"field"],[1,"field__label"],["type","number","inputmode","decimal","formControlName","amount","placeholder","0",1,"input"],["class","error",4,"ngIf"],["formControlName","category",1,"input"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","description","placeholder","\u0645\u062B\u0627\u0644: \u063A\u062F\u0627\u0621",1,"input"],["type","date","formControlName","date",1,"input"],["type","time","formControlName","time",1,"input"],["formControlName","paymentMethod",1,"input"],["value","cash"],["value","card"],["value","digital_wallet"],[1,"actions"],["type","submit",1,"btn","btn--primary"],["type","button",1,"btn",3,"click"],[1,"error"],[3,"value"]],template:function(o,a){o&1&&(t(0,"section",0)(1,"div")(2,"h1",1),n(3),e(),t(4,"div",2),n(5,"\u0633\u062C\u0651\u0644 \u0645\u0635\u0631\u0648\u0641\u0643 \u0628\u0633\u0631\u0639\u0629 \u0648\u0628\u0648\u0636\u0648\u062D"),e()(),t(6,"a",3)(7,"mat-icon"),n(8,"arrow_forward"),e()()(),t(9,"form",4),c("ngSubmit",function(){return a.save()}),t(10,"div",5)(11,"label",6)(12,"div",7),n(13,"\u0627\u0644\u0645\u0628\u0644\u063A (\u062C.\u0645)"),e(),m(14,"input",8),p(15,X,2,0,"div",9),e(),t(16,"label",6)(17,"div",7),n(18,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),e(),t(19,"select",10),p(20,$,2,2,"option",11),e()()(),t(21,"label",6)(22,"div",7),n(23,"\u0627\u0644\u0648\u0635\u0641"),e(),m(24,"input",12),e(),t(25,"div",5)(26,"label",6)(27,"div",7),n(28,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),e(),m(29,"input",13),e(),t(30,"label",6)(31,"div",7),n(32,"\u0627\u0644\u0648\u0642\u062A"),e(),m(33,"input",14),e()(),t(34,"div",5)(35,"label",6)(36,"div",7),n(37,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),e(),t(38,"select",15)(39,"option",16),n(40,"\u0646\u0642\u062F\u064A"),e(),t(41,"option",17),n(42,"\u0628\u0637\u0627\u0642\u0629"),e(),t(43,"option",18),n(44,"\u0645\u062D\u0641\u0638\u0629"),e()()()(),t(45,"div",19)(46,"button",20),n(47,"\u062D\u0641\u0638"),e(),t(48,"button",21),c("click",function(){return a.cancel()}),n(49,"\u0625\u0644\u063A\u0627\u0621"),e()()()),o&2&&(u(3),g(a.isEdit()?"\u062A\u0639\u062F\u064A\u0644 \u0645\u0635\u0631\u0648\u0641":"\u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641"),u(6),d("formGroup",a.form),u(6),d("ngIf",a.form.controls.amount.touched&&a.form.controls.amount.invalid),u(5),d("ngForOf",a.categories))},dependencies:[R,S,F,D,w,k,I,O,P,A,N,_,y,M,B,T,V],styles:[`.head[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:.75rem;margin-bottom:1rem;animation:slideDown .4s ease-out}.title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:800;letter-spacing:-.02em;background:var(--primary-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.subtitle[_ngcontent-%COMP%]{margin-top:.25rem;font-size:.8125rem;color:var(--text-muted);font-weight:500}.link[_ngcontent-%COMP%]{font-size:.8125rem;text-decoration:none;color:var(--primary);padding:.5rem .75rem;border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface);transition:all .25s ease;display:flex;align-items:center;gap:.375rem;font-weight:600}.link[_ngcontent-%COMP%]:hover{background:var(--bg-secondary);transform:translate(-2px);box-shadow:var(--shadow-sm)}.link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.form[_ngcontent-%COMP%]{border:1px solid var(--border);background:var(--surface);border-radius:var(--radius-xl);padding:1.5rem;box-shadow:var(--shadow-md);animation:scaleIn .3s ease-out;transition:all .3s ease}.form[_ngcontent-%COMP%]:hover{box-shadow:var(--shadow-lg)}.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}@media (max-width: 720px){.row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.field[_ngcontent-%COMP%]{display:grid;gap:.5rem;margin-bottom:1rem;position:relative}.field__label[_ngcontent-%COMP%]{font-size:.8125rem;color:var(--text-secondary);font-weight:600;display:flex;align-items:center;gap:.375rem}.field__label[_ngcontent-%COMP%]:before{content:"";width:4px;height:4px;border-radius:50%;background:var(--primary)}.input[_ngcontent-%COMP%]{width:100%;border:1px solid var(--border);background:var(--bg-secondary);border-radius:var(--radius-md);padding:.875rem 1rem;font-size:.9375rem;outline:none;color:var(--text-primary);transition:all .25s ease;font-family:inherit}.input[_ngcontent-%COMP%]::placeholder{color:var(--text-muted)}.input[_ngcontent-%COMP%]:focus{border-color:var(--primary);background:var(--surface);box-shadow:0 0 0 3px color-mix(in srgb,var(--primary) 15%,transparent);transform:translateY(-1px)}.input[_ngcontent-%COMP%]:hover:not(:focus){border-color:var(--primary-light)}select.input[_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236366f1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:left .75rem center;background-size:1rem;padding-left:2.5rem}select.input[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:var(--surface);color:var(--text-primary)}.error[_ngcontent-%COMP%]{font-size:.75rem;color:var(--danger);font-weight:500;display:flex;align-items:center;gap:.375rem;animation:fadeIn .2s ease-out}.error[_ngcontent-%COMP%]:before{content:"!";width:14px;height:14px;border-radius:50%;background:var(--danger);color:#fff;font-size:.625rem;font-weight:700;display:flex;align-items:center;justify-content:center}.actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-start;margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border-light)}.btn[_ngcontent-%COMP%]{border:1px solid var(--border);background:transparent;color:var(--text-primary);border-radius:var(--radius-md);padding:.75rem 1.25rem;cursor:pointer;font-weight:600;font-size:.875rem;transition:all .25s ease;display:flex;align-items:center;gap:.5rem}.btn[_ngcontent-%COMP%]:hover{background:var(--bg-secondary);transform:translateY(-1px)}.btn[_ngcontent-%COMP%]:active{transform:translateY(0) scale(.98)}.btn--primary[_ngcontent-%COMP%]{background:var(--primary-gradient);color:#fff;border-color:transparent;box-shadow:0 4px 12px #6366f14d}.btn--primary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 16px #6366f166;transform:translateY(-2px)}.btn--primary[_ngcontent-%COMP%]:active{transform:translateY(0) scale(.98)}@media (max-width: 480px){.head[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.title[_ngcontent-%COMP%]{font-size:1.25rem}.form[_ngcontent-%COMP%]{padding:1.25rem}.input[_ngcontent-%COMP%]{padding:.75rem .875rem;font-size:.875rem}.actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}`]})};export{L as AddExpenseComponent};
