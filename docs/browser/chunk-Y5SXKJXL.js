import{a as L}from"./chunk-6BEIHAVR.js";import{F as V,G as B,N as G}from"./chunk-UM43KZWY.js";import{a as q}from"./chunk-DRIQLEBV.js";import"./chunk-EV7PFGVU.js";import{a as A,b as u,d as M,e as w,g as N,h as O,i as P,j as F,k as I,l as k,m as D,n as R,o as T}from"./chunk-S33ANCWB.js";import{a as z}from"./chunk-HVD7EZ4V.js";import{$a as f,Ab as E,Ca as s,Da as t,Ea as e,Fa as p,Kb as _,La as c,Mb as C,N as d,Nb as S,_a as i,a as g,ga as l,l as x,mb as v,nb as h,ra as b,wa as m,zb as y}from"./chunk-IKTNIUHG.js";var j=["\u0637\u0639\u0627\u0645","\u0645\u0648\u0627\u0635\u0644\u0627\u062A","\u062A\u0633\u0648\u0642","\u0641\u0648\u0627\u062A\u064A\u0631","\u0635\u062D\u0629","\u062A\u0639\u0644\u064A\u0645","\u062A\u0631\u0641\u064A\u0647","\u0645\u0646\u0632\u0644","\u0647\u062F\u0627\u064A\u0627","\u0623\u062E\u0631\u0649"];function $(r,n){r&1&&(t(0,"div",22),i(1," \u0623\u062F\u062E\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D "),e())}function H(r,n){if(r&1&&(t(0,"option",23),i(1),e()),r&2){let o=n.$implicit;s("value",o),l(),f(o)}}var U=class r{fb=d(R);expenses=d(q);toast=d(z);route=d(_);router=d(C);id=L(this.route.paramMap.pipe(x(n=>n.get("id"))),{initialValue:null});isEdit=v(()=>!!this.id());defaults=this.expenses.createDefaultsForNow();categories=j;form=this.fb.group({amount:this.fb.control(this.defaults.amount,[u.required,u.min(.01)]),category:this.fb.control(this.defaults.category,[u.required]),description:this.fb.control(this.defaults.description),date:this.fb.control(this.defaults.date,[u.required]),time:this.fb.control(this.defaults.time,[u.required]),paymentMethod:this.fb.control(this.defaults.paymentMethod,[u.required])});loadedId=null;constructor(){h(()=>{let n=this.id();this.tryLoad(n)})}async tryLoad(n){if(!n||this.loadedId===n)return;this.loadedId=n;let o=await this.expenses.getById(n);if(!o){this.toast.show("\u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u063A\u064A\u0631 \u0645\u0648\u062C\u0648\u062F","danger"),await this.router.navigateByUrl("/");return}this.form.patchValue({amount:o.amount,category:o.category,description:o.description,date:o.date,time:o.time,paymentMethod:o.paymentMethod})}async save(){if(this.form.invalid){this.form.markAllAsTouched();return}let n=this.form.getRawValue();if(this.isEdit()){if(!await this.expenses.update(g({id:this.id()},n))){this.toast.show("\u062A\u0639\u0630\u0631 \u0627\u0644\u062D\u0641\u0638","danger");return}this.toast.show("\u062A\u0645 \u0627\u0644\u062A\u062D\u062F\u064A\u062B","success")}else await this.expenses.add(n),this.toast.show("\u062A\u0645\u062A \u0627\u0644\u0625\u0636\u0627\u0641\u0629","success");await this.router.navigateByUrl("/")}async cancel(){await this.router.navigateByUrl("/")}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=b({type:r,selectors:[["app-add-expense"]],decls:50,vars:4,consts:[[1,"head"],[1,"title"],[1,"subtitle"],["routerLink","/",1,"link"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"field"],[1,"field__label"],["type","number","inputmode","decimal","formControlName","amount","placeholder","0",1,"input"],["class","error",4,"ngIf"],["formControlName","category",1,"input"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","description","placeholder","\u0645\u062B\u0627\u0644: \u063A\u062F\u0627\u0621",1,"input"],["type","date","formControlName","date",1,"input"],["type","time","formControlName","time",1,"input"],["formControlName","paymentMethod",1,"input"],["value","cash"],["value","card"],["value","digital_wallet"],[1,"actions"],["type","submit",1,"btn","btn--primary"],["type","button",1,"btn",3,"click"],[1,"error"],[3,"value"]],template:function(o,a){o&1&&(t(0,"section",0)(1,"div")(2,"h1",1),i(3),e(),t(4,"div",2),i(5,"\u0633\u062C\u0651\u0644 \u0645\u0635\u0631\u0648\u0641\u0643 \u0628\u0633\u0631\u0639\u0629 \u0648\u0628\u0648\u0636\u0648\u062D"),e()(),t(6,"a",3)(7,"mat-icon"),i(8,"arrow_forward"),e()()(),t(9,"form",4),c("ngSubmit",function(){return a.save()}),t(10,"div",5)(11,"label",6)(12,"div",7),i(13,"\u0627\u0644\u0645\u0628\u0644\u063A (\u062C.\u0645)"),e(),p(14,"input",8),m(15,$,2,0,"div",9),e(),t(16,"label",6)(17,"div",7),i(18,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),e(),t(19,"select",10),m(20,H,2,2,"option",11),e()()(),t(21,"label",6)(22,"div",7),i(23,"\u0627\u0644\u0648\u0635\u0641"),e(),p(24,"input",12),e(),t(25,"div",5)(26,"label",6)(27,"div",7),i(28,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),e(),p(29,"input",13),e(),t(30,"label",6)(31,"div",7),i(32,"\u0627\u0644\u0648\u0642\u062A"),e(),p(33,"input",14),e()(),t(34,"div",5)(35,"label",6)(36,"div",7),i(37,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),e(),t(38,"select",15)(39,"option",16),i(40,"\u0646\u0642\u062F\u064A"),e(),t(41,"option",17),i(42,"\u0628\u0637\u0627\u0642\u0629"),e(),t(43,"option",18),i(44,"\u0645\u062D\u0641\u0638\u0629"),e()()()(),t(45,"div",19)(46,"button",20),i(47,"\u062D\u0641\u0638"),e(),t(48,"button",21),c("click",function(){return a.cancel()}),i(49,"\u0625\u0644\u063A\u0627\u0621"),e()()()),o&2&&(l(3),f(a.isEdit()?"\u062A\u0639\u062F\u064A\u0644 \u0645\u0635\u0631\u0648\u0641":"\u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641"),l(6),s("formGroup",a.form),l(6),s("ngIf",a.form.controls.amount.touched&&a.form.controls.amount.invalid),l(5),s("ngForOf",a.categories))},dependencies:[T,N,k,D,A,O,I,M,w,P,F,E,y,S,B,V,G],styles:[".head[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:14px}.title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:900;letter-spacing:-.02em}.subtitle[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;color:var(--muted)}.link[_ngcontent-%COMP%]{font-size:12px;text-decoration:none;color:var(--primary);padding:8px 10px;border-radius:12px;border:1px solid var(--border);background:var(--surface)}.form[_ngcontent-%COMP%]{border:1px solid var(--border);background:var(--surface);border-radius:18px;padding:14px;box-shadow:var(--shadow)}.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}@media (max-width: 720px){.row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.field[_ngcontent-%COMP%]{display:grid;gap:8px;margin-bottom:12px}.field__label[_ngcontent-%COMP%]{font-size:12px;color:var(--muted)}.input[_ngcontent-%COMP%]{border:1px solid var(--border);background:color-mix(in srgb,var(--surface) 70%,var(--bg));border-radius:14px;padding:12px;font-size:14px;outline:none}.input[_ngcontent-%COMP%]:focus{border-color:color-mix(in srgb,var(--primary) 30%,var(--border));box-shadow:0 0 0 4px color-mix(in srgb,var(--primary) 12%,transparent)}.error[_ngcontent-%COMP%]{font-size:12px;color:var(--danger)}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-start;margin-top:8px}.btn[_ngcontent-%COMP%]{border:1px solid var(--border);background:transparent;color:var(--text);border-radius:14px;padding:10px 12px;cursor:pointer;font-weight:900}.btn--primary[_ngcontent-%COMP%]{background:var(--primary);color:#fff;border-color:color-mix(in srgb,var(--primary) 60%,black);box-shadow:0 16px 30px #1e3a8a40}"]})};export{U as AddExpenseComponent};
