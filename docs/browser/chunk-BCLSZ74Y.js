import{a as $}from"./chunk-SCVJ2RMO.js";import"./chunk-UWH5KVW3.js";import{A as N,v as T,w as L,x as F,z as B}from"./chunk-4RXWAYQZ.js";import{a as z,b as j,c as R,d as x,e as V}from"./chunk-NPEF2VTF.js";import{a as W}from"./chunk-I7XIT37J.js";import{a as K}from"./chunk-GZQS35Q3.js";import{$a as l,Aa as f,Ea as P,Ga as O,Ha as h,L as g,N as C,Na as b,O as k,Oa as w,Qa as n,Ra as M,Sa as u,Xa as m,Ya as p,ba as r,jb as S,kb as D,lb as A,ma as E,ra as _,ua as y,vb as I,xa as c,ya as t,za as e}from"./chunk-LKXSVSE5.js";function G(o,a){let d=j(),i=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??d.weekStartsOn??d.locale?.options?.weekStartsOn??0,s=z(o,a?.in),v=s.getDay(),q=(v<i?-7:0)+6-(v-i);return s.setDate(s.getDate()+q),s.setHours(23,59,59,999),s}function J(o,a){o&1&&(t(0,"div",24),n(1,"\u0627\u0642\u062A\u0631\u0628\u062A \u0645\u0646 \u0627\u0644\u062D\u062F \u0627\u0644\u064A\u0648\u0645\u064A"),e())}function Q(o,a){o&1&&(t(0,"div",24),n(1,"\u062A\u0645 \u062A\u062C\u0627\u0648\u0632 \u0627\u0644\u062D\u062F \u0627\u0644\u064A\u0648\u0645\u064A"),e())}function U(o,a){o&1&&(t(0,"div",24),n(1,"\u0627\u0642\u062A\u0631\u0628\u062A \u0645\u0646 \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0633\u0628\u0648\u0639\u064A"),e())}function X(o,a){o&1&&(t(0,"div",24),n(1,"\u062A\u0645 \u062A\u062C\u0627\u0648\u0632 \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0633\u0628\u0648\u0639\u064A"),e())}function Y(o,a){o&1&&(t(0,"div")(1,"div",25)(2,"mat-icon",26),n(3,"receipt_long"),e(),t(4,"p"),n(5,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0635\u0631\u0648\u0641\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),e()()())}function Z(o,a){if(o&1){let d=P();t(0,"div")(1,"div",29)(2,"div",30)(3,"span",31),n(4),e(),t(5,"span",32),n(6),m(7,"number"),e()(),t(8,"button",33),O("click",function(){let s=C(d).$implicit,v=h(2);return k(v.deleteExpense(s.id))}),t(9,"mat-icon"),n(10,"delete"),e()()()()}if(o&2){let d=a.$implicit;r(4),M(d.category),r(2),u("",p(7,2,d.amount,"1.0-2")," \u062C.\u0645")}}function ee(o,a){if(o&1&&(t(0,"div")(1,"div",27),_(2,Z,11,5,"div",28),e()()),o&2){let d=h();r(2),c("ngForOf",d.todayExpenses())}}var H=class o{expenses=g(V);settings=g(W);toast=g(K);confirm=g($);now=new Date;todayKey=x(this.now,"yyyy-MM-dd");todayLabel=new Intl.DateTimeFormat("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(this.now);alertsEnabled=l(()=>this.settings.settings().alertsEnabled);dailyLimit=l(()=>this.settings.settings().dailyLimit);weeklyLimit=l(()=>this.settings.settings().weeklyLimit);todayExpenses=this.expenses.expensesByDate(this.todayKey);todayTotal=this.expenses.totalByDate(this.todayKey);remaining=l(()=>this.dailyLimit()-this.todayTotal());progress=l(()=>{let a=this.dailyLimit();return a<=0?0:Math.min(1,Math.max(0,this.todayTotal()/a))});progressKind=l(()=>{let a=this.progress();return a>=1?"danger":a>=.8?"warning":"success"});weekStartKey=x(R(this.now,{weekStartsOn:6}),"yyyy-MM-dd");weekEndKey=x(G(this.now,{weekStartsOn:6}),"yyyy-MM-dd");weeklyTotal=l(()=>{let a=this.weekStartKey,d=this.weekEndKey,i=0;for(let s of this.expenses.expenses())s.archived||s.date<a||s.date>d||(i+=s.amount);return i});weeklyRemaining=l(()=>this.weeklyLimit()-this.weeklyTotal());weeklyProgress=l(()=>{let a=this.weeklyLimit();return a<=0?0:Math.min(1,Math.max(0,this.weeklyTotal()/a))});weeklyProgressKind=l(()=>{let a=this.weeklyProgress();return a>=1?"danger":a>=.8?"warning":"success"});async deleteExpense(a){await this.confirm.confirm("\u0647\u0644 \u062A\u0631\u064A\u062F \u062D\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u061F","\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641")&&(await this.expenses.archive(a),this.toast.show("\u062A\u0645 \u0623\u0631\u0634\u0641\u0629 \u0627\u0644\u0645\u0635\u0631\u0648\u0641 (\u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0631\u0627\u062C\u0639)","success"))}static \u0275fac=function(d){return new(d||o)};static \u0275cmp=E({type:o,selectors:[["app-dashboard"]],decls:104,vars:45,consts:[[1,"hero"],[1,"hero__left"],[1,"hero__title"],[1,"hero__date"],["mat-fab","","routerLink","/expense","color","primary",1,"hero__fab"],[1,"grid","grid--three"],[1,"card","card--stat"],[1,"card__icon"],[1,"card__content"],[1,"card__label"],[1,"card__value"],[1,"card","card--stat","card--accent"],[1,"card","card--progress"],[1,"card__header"],[1,"card__title"],[1,"card__meta"],[1,"card__body"],[1,"bar__track"],[1,"bar__fill"],["class","bar__hint",4,"ngIf"],[1,"grid","grid--two"],[1,"card"],["mat-icon-button","","routerLink","/add-expense",1,"card__action"],[4,"ngIf"],[1,"bar__hint"],[1,"empty-state"],[1,"empty-state__icon"],[1,"expense-list"],[4,"ngFor","ngForOf"],[1,"expense-item"],[1,"expense-item__main"],[1,"expense-item__category"],[1,"expense-item__amount"],["mat-icon-button","",1,"expense-item__delete",3,"click"]],template:function(d,i){d&1&&(t(0,"section",0)(1,"div",1)(2,"h1",2),n(3,"\u0627\u0644\u064A\u0648\u0645"),e(),t(4,"div",3),n(5),e()(),t(6,"button",4)(7,"mat-icon"),n(8,"add"),e()()(),t(9,"section",5)(10,"div",6)(11,"div",7)(12,"mat-icon"),n(13,"today"),e()(),t(14,"div",8)(15,"div",9),n(16,"\u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u0627\u0644\u064A\u0648\u0645"),e(),t(17,"div",10),n(18),m(19,"number"),e()()(),t(20,"div",6)(21,"div",7)(22,"mat-icon"),n(23,"limit"),e()(),t(24,"div",8)(25,"div",9),n(26,"\u0627\u0644\u062D\u062F \u0627\u0644\u064A\u0648\u0645\u064A"),e(),t(27,"div",10),n(28),m(29,"number"),e()()(),t(30,"div",11)(31,"div",7)(32,"mat-icon"),n(33,"account_balance_wallet"),e()(),t(34,"div",8)(35,"div",9),n(36,"\u0627\u0644\u0645\u062A\u0628\u0642\u064A"),e(),t(37,"div",10),n(38),m(39,"number"),e()()()(),t(40,"section",12)(41,"div",13)(42,"div",14)(43,"mat-icon"),n(44,"trending_up"),e(),t(45,"span"),n(46,"\u062A\u0642\u062F\u0645 \u0627\u0644\u064A\u0648\u0645"),e()(),t(47,"div",15),n(48),m(49,"number"),e()(),t(50,"div",16)(51,"div",17),f(52,"div",18),e(),_(53,J,2,0,"div",19)(54,Q,2,0,"div",19),e()(),t(55,"section",20)(56,"div",6)(57,"div",7)(58,"mat-icon"),n(59,"date_range"),e()(),t(60,"div",8)(61,"div",9),n(62,"\u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u0647\u0630\u0627 \u0627\u0644\u0623\u0633\u0628\u0648\u0639"),e(),t(63,"div",10),n(64),m(65,"number"),e()()(),t(66,"div",6)(67,"div",7)(68,"mat-icon"),n(69,"savings"),e()(),t(70,"div",8)(71,"div",9),n(72,"\u0627\u0644\u0645\u062A\u0628\u0642\u064A \u0623\u0633\u0628\u0648\u0639\u064A\u0627\u064B"),e(),t(73,"div",10),n(74),m(75,"number"),e()()()(),t(76,"section",12)(77,"div",13)(78,"div",14)(79,"mat-icon"),n(80,"calendar_month"),e(),t(81,"span"),n(82,"\u062A\u0642\u062F\u0645 \u0627\u0644\u0623\u0633\u0628\u0648\u0639"),e()(),t(83,"div",15),n(84),m(85,"number"),e()(),t(86,"div",16)(87,"div",17),f(88,"div",18),e(),_(89,U,2,0,"div",19)(90,X,2,0,"div",19),e()(),t(91,"section",21)(92,"div",13)(93,"div",14)(94,"mat-icon"),n(95,"receipt_long"),e(),t(96,"span"),n(97,"\u0645\u0635\u0631\u0648\u0641\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),e()(),t(98,"button",22)(99,"mat-icon"),n(100,"add"),e()()(),t(101,"div",16),_(102,Y,6,0,"div",23)(103,ee,3,1,"div",23),e()()),d&2&&(r(5),M(i.todayLabel),r(13),u("",p(19,24,i.todayTotal(),"1.0-2")," \u062C.\u0645"),r(10),u("",p(29,27,i.dailyLimit(),"1.0-2")," \u062C.\u0645"),r(9),w("is-negative",i.remaining()<0),r(),u(" ",p(39,30,i.remaining(),"1.0-2")," \u062C.\u0645 "),r(10),u("",p(49,33,i.progress()*100,"1.0-0"),"%"),r(3),y("data-kind",i.progressKind()),r(),b("width",i.progress()*100,"%"),r(),c("ngIf",i.alertsEnabled()&&i.progress()>=.8&&i.progress()<1),r(),c("ngIf",i.alertsEnabled()&&i.progress()>=1),r(10),u("",p(65,36,i.weeklyTotal(),"1.0-2")," \u062C.\u0645"),r(9),w("is-negative",i.weeklyRemaining()<0),r(),u(" ",p(75,39,i.weeklyRemaining(),"1.0-2")," \u062C.\u0645 "),r(10),u("",p(85,42,i.weeklyProgress()*100,"1.0-0"),"%"),r(3),y("data-kind",i.weeklyProgressKind()),r(),b("width",i.weeklyProgress()*100,"%"),r(),c("ngIf",i.alertsEnabled()&&i.weeklyProgress()>=.8&&i.weeklyProgress()<1),r(),c("ngIf",i.alertsEnabled()&&i.weeklyProgress()>=1),r(12),c("ngIf",i.todayExpenses().length===0),r(),c("ngIf",i.todayExpenses().length>0))},dependencies:[D,S,I,L,T,N,F,B,A],styles:[".hero[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px}.hero__title[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:700;letter-spacing:-.02em}.hero__date[_ngcontent-%COMP%]{margin-top:4px;font-size:14px;color:var(--muted)}.hero__fab[_ngcontent-%COMP%]{width:48px;height:48px}.grid[_ngcontent-%COMP%]{display:grid;gap:12px;margin-bottom:16px}.grid--three[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}.grid--two[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}@media (max-width: 720px){.grid--three[_ngcontent-%COMP%], .grid--two[_ngcontent-%COMP%]{grid-template-columns:1fr}}.card[_ngcontent-%COMP%]{border:1px solid var(--border);background:var(--surface);border-radius:20px;padding:16px;box-shadow:0 4px 20px #00000014}.card--stat[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px}.card__icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:14px;background:color-mix(in srgb,var(--primary) 10%,var(--surface));display:flex;align-items:center;justify-content:center;color:var(--primary);font-size:24px;flex-shrink:0}.card__content[_ngcontent-%COMP%]{flex:1;min-width:0}.card--accent[_ngcontent-%COMP%]   .card__icon[_ngcontent-%COMP%]{background:var(--primary);color:#fff}.card__label[_ngcontent-%COMP%]{font-size:12px;color:var(--muted);font-weight:500}.card__value[_ngcontent-%COMP%]{margin-top:4px;font-size:22px;font-weight:700;letter-spacing:-.02em}.is-negative[_ngcontent-%COMP%]{color:var(--danger)}.card--progress[_ngcontent-%COMP%]{margin-bottom:16px}.card__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px}.card__title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:600;letter-spacing:-.01em}.card__title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.card__meta[_ngcontent-%COMP%]{font-size:12px;color:var(--muted);font-weight:600}.card__body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.bar__track[_ngcontent-%COMP%]{height:8px;border-radius:999px;background:color-mix(in srgb,var(--border) 50%,var(--surface));overflow:hidden}.bar__fill[_ngcontent-%COMP%]{height:100%;width:0;border-radius:999px;background:var(--success);transition:width .22s ease}.bar__track[data-kind=warning][_ngcontent-%COMP%]   .bar__fill[_ngcontent-%COMP%]{background:var(--warning)}.bar__track[data-kind=danger][_ngcontent-%COMP%]   .bar__fill[_ngcontent-%COMP%]{background:var(--danger)}.bar__hint[_ngcontent-%COMP%]{margin-top:8px;font-size:12px;color:var(--muted)}.expense-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.expense-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px;border-radius:12px;background:color-mix(in srgb,var(--border) 30%,var(--surface))}.expense-item__main[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;flex:1;min-width:0}.expense-item__category[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.expense-item__amount[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.expense-item__delete[_ngcontent-%COMP%]{color:var(--danger)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:32px 16px;color:var(--muted);text-align:center}.empty-state__icon[_ngcontent-%COMP%]{font-size:48px;opacity:.5}.card__action[_ngcontent-%COMP%]{color:var(--primary)}"]})};export{H as DashboardComponent};
